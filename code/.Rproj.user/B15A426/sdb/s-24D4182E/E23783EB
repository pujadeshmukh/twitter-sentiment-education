{
    "contents" : "\nclear.location <- function(txt){\n  # remove retweet entities\n  txt <- gsub(\"(RT|via)((?:\\\\b\\\\W*@\\\\w+)+)\", \"\", txt)\n  # remove at people\n  txt <- gsub(\"@\\\\w+\", \"\", txt)\n  # remove numbers\n  txt <- gsub(\"[[:digit:]]\", \"\", txt)\n  txt <- gsub(\",\", \"0\", txt)\n  # remove punctuation\n  txt <- gsub(\"[[:punct:]]\", \"\", txt)\n  # remove html links\n  txt <- gsub(\"http\\\\w+\", \"\", txt)\n  # remove unnecessary spaces\n  txt <- gsub(\"[ \\t]{2,}\", \"\", txt)\n  txt <- gsub(\"^\\\\s+|\\\\s+$\", \"\", txt)\n  \n  txt <- gsub(\"[[:space:]]\", \",\", txt)\n  txt <- gsub(\"0\", \",\", txt)\n  txt <- gsub(\"[,]{2,}\", \",\", txt)\n  txt\n}\n\nclear.text <- function(txt){\n  # remove retweet entities\n  txt <- gsub(\"(RT|via)((?:\\\\b\\\\W*@\\\\w+)+)\", \"\", txt)\n  # remove at people\n  txt <- gsub(\"@\\\\w+\", \"\", txt)\n#   #remove punctuation\n  txt <- gsub(\"[[:punct:]]\", \"\", txt)\n#   #remove numbers\n  txt <- gsub(\"[[:digit:]]\", \"\", txt)\n  # remove html links\n  txt <- gsub(\"http\\\\w+\", \"\", txt)\n  # everything else\n  txt <- gsub(\"[^a-zA-Z ]\", \"\", txt)\n  # remove unnecessary spaces\n#   txt <- gsub(\"[\\n]\", \" \", txt)\n  txt <- gsub(\"[ ]{2,}\", \" \", txt)\n  txt <- gsub(\"^\\\\s+|\\\\s+$\", \"\", txt)\n  txt\n}\n\ngeo.coordinates <- function(name){\n  res <- getURL(\"http://api.geonames.org/searchJSON\", \n                postfields=paste0(\"q=\",name,\"&maxRows=1&fuzzy=0.8&username=redmode\"))\n  res <- fromJSON(res)\n  ret <- list(lat=NA,lng=NA,country=NA,code=NA)\n  \n  if(!is.null(res$totalResultsCount)){\n    if(res$totalResultsCount>0){\n      ret$lat <- res$geonames[[1]]$lat\n      ret$lng <- res$geonames[[1]]$lng\n      ret$country <- res$geonames[[1]]$countryName\n      ret$code <- res$geonames[[1]]$countryCode\n    }\n  }\n  else if(!is.null(res$status$value)){\n    if(res$status$value == 19){\n      stop(\"Sorry, geonames.org quota exceeded... Try again in one hour...\")\n    }\n  }\n  \n  ret\n}\n\ngeo.names <- function(lat,lng){\n  res <- getURL(\"http://api.geonames.org/findNearbyPlaceNameJSON\", \n                postfields=paste0(\"lat=\",lat,\"&lng=\",lng,\"&username=redmode\"))\n  res <- fromJSON(res)\n  ret <- list(lat=NA,lng=NA,country=NA,code=NA)\n  \n  if(!is.null(res$geonames)){\n    if(length(res$geonames)>0){\n      ret$lat <- res$geonames[[1]]$lat\n      ret$lng <- res$geonames[[1]]$lng\n      ret$country <- res$geonames[[1]]$countryName\n      ret$code <- res$geonames[[1]]$countryCode\n    }\n  }\n  else if(!is.null(res$status$value)){\n    if(res$status$value == 19){\n      stop(\"Sorry, geonames.org quota exceeded... Try again in one hour...\")\n    }\n  }\n\n  ret\n}\n\n",
    "created" : 1364888874822.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1192071338",
    "id" : "E23783EB",
    "lastKnownWriteTime" : 1364976198,
    "path" : "~/docs/Dropbox/Docs/study/Publications/2013/2013-03-IOT/code/utils.R",
    "properties" : {
    },
    "source_on_save" : true,
    "type" : "r_source"
}